<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <title>Jogo</title>
</head>
<body>
    <div class="master">
        <h1>Jogo da Memória Sustentável</h1>
        <div class="cartas">
            <div class="field" id="1">
                <div class="inner-wrap">
                    <div class="front"></div>
                    <div class="back"></div>	
                </div>
            </div>
            <div class="field" id="2">
                <div class="inner-wrap">
                    <div class="front"></div>
                    <div class="back"></div>	
                </div>
            </div>
            <div class="field" id="3">
                <div class="inner-wrap">
                    <div class="front"></div>
                    <div class="back"></div>	
                </div>
            </div>
            <div class="field" id="4">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="5">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="6">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="7">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="8">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="9">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="10">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="11">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="12">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="13">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="14">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="15">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="16">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="17">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="18">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="19">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
            <div class="field" id="20">
                    <div class="inner-wrap">
                        <div class="front"></div>
                        <div class="back"></div>	
                    </div>
            </div>
        </div>
        <div class="placar">
            <span>Placar</span>
            <p class="counter"></p>
        </div>
        <div class="controler">

        </div>
    </div>
    <script type="text/javascript">
        $(document).ready(function(){
	
        var checkArray = []; 
        var idCheck = []; 
        var counter = 0;
        var end = 0; 
        var fields = document.querySelectorAll(".back");
        
        var images = [
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg",
            "img/compostagem.jpg"
        ];
    
        function clicked() { 
            if ($(this).find(".inner-wrap").hasClass("flipped")) {
                return;
            }
            $(this).find(".inner-wrap").toggleClass("flipped");
            checkArray.push($(this).find("img").attr("src"));
            idCheck.push($(this).attr("id"));
            check();
        }
    
        $(".field").on("click", clicked);
        
    
        function restart() {
            $(".back").find("img").remove(); 
            $(".field .inner-wrap").removeClass("flipped"); 
            checkArray = []; 
            idCheck = []; 
            counter = 0; 
            end = 0; 
            startGame();
        }
    
        function checkEnd() {
            if (end === 20) { 
                win.play();
                alert("Seu score eh: " + counter);
                restart();
            }
        }
    
        function shuffleArray(array) { 
            for (var i = array.length - 1; i > 0; i--) {
                var j = Math.floor(Math.random() * (i + 1));
                var temp = array[i];
                array[i] = array[j];
                array[j] = temp;
            }
            return array;
        }
    
        function startGame() {    
            var arr = shuffleArray(images); // stores the array of shuffled images
            
            for (var i = 0; i < fields.length; i++) { // appending those images to the div with class "back"
                var img = document.createElement("img");
                img.src = arr[i];
                console.log(img);
                fields[i].appendChild(img);
            }
    
    
    }
    
    function check() {
        if (checkArray.length === 2) { 
            $(".field").off("click", clicked);
            setTimeout(function(){
                if (checkArray[0] !== checkArray[1]) {
                    $("#" + idCheck[0]).find(".inner-wrap").removeClass("flipped");
                    $("#" + idCheck[1]).find(".inner-wrap").removeClass("flipped");
                    counter++;
                    checkArray = [];
                    idCheck = []; 
                    $(".field").on("click", clicked);
                } else {
                   counter++;
                    end += 2;
                    checkArray = []; 
                    idCheck = []; 
                    checkEnd(); 
                    $(".field").on("click", clicked);
                }
                document.querySelector(".counter").innerHTML = counter;
            }, 800);	
        }
    }
    
    
    
    startGame();
    
    });
    
    </script>
</body>
</html>